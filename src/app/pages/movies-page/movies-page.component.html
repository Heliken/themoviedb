<form [formGroup]="controlsFormGroup">
  <div class="movies-page">
    <div class="container">
      <h1 class="movies-page--title h2">Explore our movies library</h1>

      <div class="movies-page--controls">
        <mdb-movies-page-filters class="movies-page--filters">
          <div class="movies-page-filter">
            <p class="movies-page-filter--title">Choose release date:</p>
            <mdb-daterange
              (dateChanged)="setReleaseDate($event)"
              [dateFormGroup]="
                controlsFormGroup.controls.releaseDate
              "></mdb-daterange>
          </div>
        </mdb-movies-page-filters>
        <mdb-select
          class="movies-page--sort"
          title="Sort by:"
          [selectControl]="controlsFormGroup.controls.sort_by"
          [options]="sortingOptions"
          (selectChange)="setSorting($event)"></mdb-select>
      </div>
    </div>
    <ng-container
      *ngIf="{ state: (isLoading$ | async) === false } as isLoading">
      <ng-container *ngIf="results$ | async as response; else preloader">
        <ng-container *ngIf="isLoading.state; else gridPreloader">
          <mdb-ui-cards-grid
            *ngIf="response.results.length; else emptyState"
            [type]="fullpageGrid"
            [dataList]="response.results | toGridItems"></mdb-ui-cards-grid>
        </ng-container>
        <mdb-pagination
          [total]="response.totalPages"
          [current]="response.page"
          (pageSelect)="setPage($event)"></mdb-pagination>
      </ng-container>
    </ng-container>

    <ng-template #preloader><mdb-preloader></mdb-preloader></ng-template>
    <ng-template #emptyState>
      <div class="container">
        <div class="movies-page--empty">
          No results matching your filters, try another search!
        </div>
      </div>
    </ng-template>
  </div>
</form>
<ng-template #gridPreloader>
  <mdb-ui-cards-grid-preloader
    [type]="fullpageGrid"></mdb-ui-cards-grid-preloader>
</ng-template>
